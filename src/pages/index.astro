---
import Layout from '../layouts/Layout.astro';

// Welcome to Astro! Wondering what to do next? Check out the Astro documentation at https://docs.astro.build
// Don't want to use any of this? Delete everything in this file, the `assets`, `components`, and `layouts` directories, and start fresh.
---

<Layout title="Dashboard SISTEQ Control">
	<div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8">
		<!-- KPIs -->
		<div class="card">
			<h3 class="text-lg font-semibold mb-2">Impresiones Totales</h3>
			<p class="text-3xl font-bold text-[#1a237e]">45,106</p>
			<p class="text-sm text-gray-600">+12.5% vs mes anterior</p>
		</div>
		<div class="card">
			<h3 class="text-lg font-semibold mb-2">Clics Totales</h3>
			<p class="text-3xl font-bold text-[#1a237e]">1,245</p>
			<p class="text-sm text-gray-600">+8.3% vs mes anterior</p>
		</div>
		<div class="card">
			<h3 class="text-lg font-semibold mb-2">CTR Promedio</h3>
			<p class="text-3xl font-bold text-[#1a237e]">2.76%</p>
			<p class="text-sm text-gray-600">+0.5% vs mes anterior</p>
		</div>
		<div class="card">
			<h3 class="text-lg font-semibold mb-2">Conversiones</h3>
			<p class="text-3xl font-bold text-[#1a237e]">31</p>
			<p class="text-sm text-gray-600">+15.2% vs mes anterior</p>
		</div>
	</div>

	<div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
		<!-- Gráfico de tendencias -->
		<div class="card">
			<h3 class="text-lg font-semibold mb-4">Tendencia de Impresiones y Clics</h3>
			<canvas id="tendenciasChart"></canvas>
		</div>

		<!-- Gráfico de ubicaciones -->
		<div class="card">
			<h3 class="text-lg font-semibold mb-4">Rendimiento por Ubicación</h3>
			<canvas id="ubicacionesChart"></canvas>
		</div>
	</div>

	<div class="card mb-8">
		<h3 class="text-lg font-semibold mb-4">Insights y Recomendaciones</h3>
		<div class="space-y-4">
			<div class="p-4 bg-blue-50 rounded-lg">
				<h4 class="font-semibold text-blue-800">Insights Positivos</h4>
				<ul class="list-disc list-inside text-blue-700">
					<li>El CTR ha mejorado un 0.5% respecto al mes anterior</li>
					<li>Las conversiones han aumentado un 15.2%</li>
					<li>La Ciudad de México y el Estado de México son las ubicaciones con mejor rendimiento</li>
				</ul>
			</div>
			<div class="p-4 bg-yellow-50 rounded-lg">
				<h4 class="font-semibold text-yellow-800">Áreas de Mejora</h4>
				<ul class="list-disc list-inside text-yellow-700">
					<li>El costo por conversión es alto en algunas ubicaciones</li>
					<li>Hay días con cero conversiones que requieren atención</li>
					<li>Algunas ubicaciones tienen muy poco tráfico</li>
				</ul>
			</div>
			<div class="p-4 bg-green-50 rounded-lg">
				<h4 class="font-semibold text-green-800">Recomendaciones</h4>
				<ul class="list-disc list-inside text-green-700">
					<li>Optimizar el presupuesto en ubicaciones con bajo rendimiento</li>
					<li>Revisar las pujas en días con alto costo por conversión</li>
					<li>Considerar expandir la campaña en las ubicaciones con mejor rendimiento</li>
					<li>Implementar estrategias específicas para mejorar las conversiones en días con bajo rendimiento</li>
				</ul>
			</div>
		</div>
	</div>
</Layout>

<script>
	declare const Chart: any;

	// Gráfico de tendencias
	const tendenciasCanvas = document.getElementById('tendenciasChart');
	if (tendenciasCanvas instanceof HTMLCanvasElement) {
		const tendenciasCtx = tendenciasCanvas.getContext('2d');
		if (tendenciasCtx) {
			new Chart(tendenciasCtx, {
				type: 'line',
				data: {
					labels: ['1 Mar', '5 Mar', '10 Mar', '15 Mar', '20 Mar', '25 Mar', '31 Mar'],
					datasets: [{
						label: 'Impresiones',
						data: [2809, 431, 2313, 3088, 4333, 1842, 2106],
						borderColor: '#1a237e',
						tension: 0.1
					}, {
						label: 'Clics',
						data: [145, 6, 62, 65, 63, 43, 35],
						borderColor: '#2196f3',
						tension: 0.1
					}]
				},
				options: {
					responsive: true,
					plugins: {
						legend: {
							position: 'top',
						}
					}
				}
			});
		}
	}

	// Gráfico de ubicaciones
	const ubicacionesCanvas = document.getElementById('ubicacionesChart');
	if (ubicacionesCanvas instanceof HTMLCanvasElement) {
		const ubicacionesCtx = ubicacionesCanvas.getContext('2d');
		if (ubicacionesCtx) {
			new Chart(ubicacionesCtx, {
				type: 'bar',
				data: {
					labels: ['CDMX', 'Estado de México', 'Jalisco', 'Nuevo León', 'Puebla'],
					datasets: [{
						label: 'Impresiones',
						data: [14275, 12660, 10023, 5434, 4766],
						backgroundColor: '#1a237e'
					}]
				},
				options: {
					responsive: true,
					plugins: {
						legend: {
							position: 'top',
						}
					}
				}
			});
		}
	}
</script>
